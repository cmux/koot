# 升级指南: 0.14 -> 0.15

---

### TL;DR 升级要点

此次更新包含诸多重大改动，对于正在使用 _Koot.js_ 0.14 的项目，可以参照下述步骤进行升级。

1. 手动更新 `package.json`，将以下依赖包更新到最新版本。
    - `autoprefixer`
    - 所有 _PostCSS_ 的插件，包括 `cssnano`
2. 修改 _Koot.js_ 配置文件 (默认为 `/koot.config.js`)：
    - 通过 `internalLoaderOptions` 选项配置 `less-loader`，添加 `math: 'always'`，代码如下：

```javascript
module.exports = {
    // ...
    internalLoaderOptions: {
        'less-loader': {
            lessOptions: {
                math: 'always',
            },
        },
    },
    // ...
};
```

3. 如果项目有定制的 _Webpack_ 配置，请参照 [Webpack 官方升级指南](https://webpack.js.org/migrate/5/) 对 _Webpack_ 配置进行手动修改，以适配 _Webpack_ 5。
    - _Koot.js_ 内部的 _Webpack_ 配置已完成升级。
4. 修改 _Babel_ 配置 (文件可能为 `/babelrc.js` `/babel.config.js`)：
    - 移除插件 `react-hot-loader/babel`
5. 排查项目代码，将所有从 `koot` 主包中引用的 `localeId` `store` `history` 依次修改为 `getLocaleId` `getStore` `getHistory`，这些替换后的变量为函数，需要调用方可得到实际的值

接下来是更详细的说明，如果对内部机制有兴趣可进行延伸阅读。

---

### Koot.js 0.15 亮点

-   TODO: HIGHLIGHT
-   TODO: typedef
-   TODO: dev env HMR speed

---

### 重大改动

**koot**

-   TODO: BREAKING CHANGES

**koot-webpack**

-   TODO: BREAKING CHANGES

---

### 其他注意事项 & 技术说明

##### React 17

##### TODO: Webpack 5

##### Less.js 4

_Koot.js_ 0.15 将内置的 _Less.js_ 升级到了 v4，后者对其默认的数值计算行为方式进行了调整。有关详情，请查阅 Less.js 官方文档: http://lesscss.org/usage/#less-options-math。
